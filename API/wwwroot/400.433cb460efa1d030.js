"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[400],{9400:(q,a,c)=>{c.r(a),c.d(a,{PostsModule:()=>J});var p=c(6814),u=c(8733),m=c(6208),t=c(4769),f=c(7203);let g=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-posts"]],decls:1,vars:0,template:function(e,n){1&e&&t._UZ(0,"app-feed")},dependencies:[f.e]}),o})();var r=c(95),h=c(5469),v=c(9847);function _(o,s){1&o&&t._UZ(0,"div",5)}function b(o,s){if(1&o&&(t.TgZ(0,"div",6),t._uU(1),t.qZA()),2&o){const e=t.oxw();t.xp6(1),t.hij("",e.label," is required")}}let C=(()=>{class o{constructor(e){this.controlDir=e,this.label="",this.controlDir.valueAccessor=this}writeValue(e){}registerOnChange(e){}registerOnTouched(e){}get control(){return this.controlDir.control}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(r.a5,2))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-text-area"]],inputs:{label:"label"},decls:6,vars:6,consts:[[1,"form-floating","mb-3"],["rows","3",1,"form-control",3,"formControl","placeholder","ngClass"],["class","fa fa-spinner fa-spin loader",4,"ngIf"],["for","floatingInput"],["class","invalid-feedback",4,"ngIf"],[1,"fa","fa-spinner","fa-spin","loader"],[1,"invalid-feedback"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0),t._UZ(1,"textarea",1),t.YNc(2,_,1,0,"div",2),t.TgZ(3,"label",3),t._uU(4),t.qZA(),t.YNc(5,b,2,1,"div",4),t.qZA()),2&e&&(t.xp6(1),t.s9C("placeholder",n.label),t.Q6J("formControl",n.control)("ngClass",n.control.touched?n.control.invalid?"is-invalid":"is-valid":null),t.xp6(1),t.Q6J("ngIf","PENDING"===n.control.status),t.xp6(2),t.Oqu(n.label),t.xp6(1),t.Q6J("ngIf",null==n.control.errors?null:n.control.errors.required))},dependencies:[p.mk,p.O5,r.Fj,r.JJ,r.oH]}),o})();function A(o,s){1&o&&(t.TgZ(0,"h1",14),t._uU(1,"Add post"),t.qZA())}function x(o,s){1&o&&(t.TgZ(0,"h1",14),t._uU(1,"Update post"),t.qZA())}function T(o,s){if(1&o&&(t.TgZ(0,"option",15),t._uU(1),t.qZA()),2&o){const e=s.$implicit,n=t.oxw();let i;t.Q6J("value",e.id)("selected",(null==(i=n.postForm.get("categoryId"))?null:i.value)===e.id),t.xp6(1),t.hij(" ",e.name," ")}}function Z(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"div",14)(1,"label",16),t._uU(2,"Upload picture"),t.qZA(),t.TgZ(3,"input",17),t.NdJ("change",function(i){t.CHM(e);const l=t.oxw();return t.KtG(l.onPictureSelected(i))}),t.qZA()()}}function F(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"div"),t._UZ(1,"img",18),t.TgZ(2,"button",19),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.removeImage())}),t._uU(3,"Remove Image"),t.qZA()()}if(2&o){const e=t.oxw();let n;t.xp6(1),t.Q6J("src",null==(n=e.postForm.get("picture"))?null:n.value,t.LSH)}}function I(o,s){if(1&o){const e=t.EpF();t.TgZ(0,"div",20)(1,"div",21),t._UZ(2,"input",22)(3,"textarea",23),t.qZA(),t.TgZ(4,"div")(5,"button",24),t.NdJ("click",function(){const l=t.CHM(e).index,S=t.oxw();return t.KtG(S.removeStep(l))}),t._uU(6,"Remove"),t.qZA()()()}2&o&&t.Q6J("formGroupName",s.index)}let d=(()=>{class o{constructor(e,n,i,l){this.fb=e,this.postService=n,this.router=i,this.route=l,this.id=this.route.snapshot.paramMap.get("id"),this.postForm=this.fb.group({title:["",r.kI.required],description:["",r.kI.required],picture:["",r.kI.required],categoryId:["",r.kI.required],steps:this.fb.array([])})}ngOnInit(){this.getCategories(),this.id&&this.getPost()}getPost(){this.id&&this.postService.getPost(this.id).subscribe({next:e=>{e.steps=e.steps.sort((i,l)=>i.stepNumber-l.stepNumber);const n=e.steps.map(i=>this.fb.group({id:[i.id],instruction:[i.instruction,r.kI.required],stepNumber:[i.stepNumber,r.kI.required]}));this.postForm=this.fb.group({title:[e.title,r.kI.required],description:[e.description,r.kI.required],picture:[e.picture,r.kI.required],categoryId:[e.category,r.kI.required],steps:this.fb.array(n)})},error:e=>console.log(e)})}get steps(){return this.postForm.get("steps")}onCategorySelected(e){this.postForm.get("categoryId")?.setValue(e.target.value)}onPictureSelected(e){const n=e.target.files[0];n&&this.postService.uploadPicture(n).subscribe({next:i=>{this.postForm.get("picture")?.setValue(i.body)},error:i=>console.log(i)})}removeImage(){const e=this.postForm.get("picture")?.value?.split("/")[7].split(".")[0];e&&this.postService.deletePicture(e).subscribe({next:()=>this.postForm.get("picture")?.setValue("")})}addStep(){this.steps.push(this.fb.group({instruction:["",r.kI.required],stepNumber:[this.steps.length+1,r.kI.required]}))}removeStep(e){this.steps.removeAt(e)}getCategories(){this.postService.getCategories().subscribe({next:e=>this.categories=[{id:"",name:"Select Category"},...e],error:e=>console.log(e)})}submitForm(){if(this.postForm.valid){const e=this.postForm.value;this.id?this.postService.updatePost(this.id,e).subscribe({next:()=>this.router.navigateByUrl("/posts")}):this.postService.createPost(e).subscribe({next:()=>this.router.navigateByUrl("/posts")})}}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(r.qu),t.Y36(h.L),t.Y36(u.F0),t.Y36(u.gz))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-add"]],decls:19,vars:11,consts:[[1,"d-flex","justify-content-center"],[1,"col-6"],[3,"formGroup","ngSubmit"],[1,"text-center","mb-4"],["class","mb-3",4,"ngIf"],[3,"formControl","label"],[1,"form-select","mb-4",3,"change"],["class","list-group-item",3,"value","selected",4,"ngFor","ngForOf"],[4,"ngIf"],["formArrayName","steps",1,"my-4"],[3,"formGroupName",4,"ngFor","ngForOf"],[1,"btn","btn-primary",3,"click"],[1,"mt-4"],[1,"btn","btn-success"],[1,"mb-3"],[1,"list-group-item",3,"value","selected"],["for","formFile",1,"form-label"],["type","file","id","formFile",1,"form-control",3,"change"],[3,"src"],["type","button",1,"btn","btn-danger","mt-2",3,"click"],[3,"formGroupName"],[1,"d-flex","flex-column","gap-2"],["formControlName","stepNumber","placeholder","Step Number",1,"form-control","mt-2"],["formControlName","instruction","placeholder","Instruction",1,"form-control"],[1,"btn","btn-danger","mt-2",3,"click"]],template:function(e,n){if(1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"form",2),t.NdJ("ngSubmit",function(){return n.submitForm()}),t.TgZ(3,"div",3),t.YNc(4,A,2,0,"h1",4),t.YNc(5,x,2,0,"h1",4),t.qZA(),t._UZ(6,"app-text-input",5)(7,"app-text-area",5),t.TgZ(8,"select",6),t.NdJ("change",function(l){return n.onCategorySelected(l)}),t.YNc(9,T,2,3,"option",7),t.qZA(),t.YNc(10,Z,4,0,"div",4),t.YNc(11,F,4,1,"div",8),t.TgZ(12,"div",9),t.YNc(13,I,7,1,"div",10),t.qZA(),t.TgZ(14,"button",11),t.NdJ("click",function(){return n.addStep()}),t._uU(15,"Add Step"),t.qZA(),t.TgZ(16,"div",12)(17,"button",13),t._uU(18,"Submit"),t.qZA()()()()()),2&e){let i,l;t.xp6(2),t.Q6J("formGroup",n.postForm),t.xp6(2),t.Q6J("ngIf",null===n.id),t.xp6(1),t.Q6J("ngIf",null!==n.id),t.xp6(1),t.Q6J("formControl",n.postForm.controls.title)("label","Title"),t.xp6(1),t.Q6J("formControl",n.postForm.controls.description)("label","Description"),t.xp6(2),t.Q6J("ngForOf",n.categories),t.xp6(1),t.Q6J("ngIf",!(null!=(i=n.postForm.get("picture"))&&i.value)),t.xp6(1),t.Q6J("ngIf",null==(l=n.postForm.get("picture"))?null:l.value),t.xp6(2),t.Q6J("ngForOf",n.steps.controls)}},dependencies:[p.sg,p.O5,r._Y,r.YN,r.Kr,r.Fj,r.JJ,r.JL,r.oH,r.sg,r.u,r.x0,r.CE,v.t,C]}),o})();const y=[{path:"",component:g},{path:"add",component:d},{path:"update/:id",component:d}];let N=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[u.Bz.forChild(y),u.Bz]}),o})(),J=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[p.ez,u.Bz,m.m,N]}),o})()}}]);